modules:
  - name: Remove current dracut
    type: packages
    body:
      remove:
        - dracut

  - name: Download needed dracut version
    type: shell
    body:
      command: |
        cd /tmp
        wget http://git.altlinux.org/tasks/384694/build/100/${{ Env.ARCH }}/rpms/dracut-107-alt1.${{ Env.ARCH }}.rpm
        rpm -i ./dracut-107-alt1.${{ Env.ARCH }}.rpm
        rm -f ./dracut-107-alt1.${{ Env.ARCH }}.rpm

  - name: Hold dracut
    type: copy
    body:
      source: files/hold-dracut.conf
      destination: /etc/apt/apt.conf.d/hold-dracut.conf
